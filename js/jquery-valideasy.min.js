(function(e){function t(e,t,r,s,o){i(e,t,r,s);if(!o){r.addClass("error")}r.bind("focus",function(){n(e,t,r,o)})}function n(e,t,n,r){relatedFields=t.attr("data-error-relatedfields");if(relatedFields){relatedFields=relatedFields.replace(" "+n.attr("id"),"");t.attr("data-error-relatedfields",relatedFields)}if(!relatedFields||relatedFields==""){t.fadeOut();t.html("")}if(!r){n.removeClass("error")}}function r(t,n,r){if(n.attr("data-error-fieldid")){errorElement=e("#"+n.attr("data-error-fieldid"))}else{if(t=="single"){r=n.attr("id")+"_"+r}errorElement=e("#"+r)}return errorElement}function i(t,n,r,i){if(r.attr("data-error-fieldname")){elementName=r.attr("data-error-fieldname")}else{elementName=r.attr("title")}if(r.attr("data-error-message-"+i)){message=r.attr("data-error-message-"+i)}else{message=messages[i];if(i=="lowerthan"||i=="greaterthan"){targetElement=e("#"+r.attr("data-error-"+i));message=message.replace("{field1}","<span class='fieldname'>"+elementName+"</span>");message=message.replace("{field2}","<span class='fieldname'>"+targetElement.attr("title")+"</span>")}else{message=message.replace("{field}","<span class='fieldname'>"+elementName+"</span>")}}relatedFields=n.attr("data-error-relatedfields")!=undefined?n.attr("data-error-relatedfields"):"";n.attr("data-error-relatedfields",relatedFields+" "+r.attr("id"));if(n.html()!=message){n.fadeIn();n.html(message)}}function s(e){if(e){e.replace(".","");e.replace(",","");e.replace(" ","")}return e}validationMethods=["required","grouprequired","integer","number","email","url","zip","phone","lowerthan","greaterthan"];patterns={integer:/^\d+$/,date:/^((0?\d)|(1[012]))[\/-]([012]?\d|30|31)[\/-]\d{1,4}$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,usd:/^\$?((\d{1,3}(,\d{3})*)|\d+)(\.(\d{2})?)?$/,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,number:/^(?=.*\d)(?:[\d \.,]+)$/,zip:/^\d{5}(-\d{4})?$/,phone:/^((0[0-9]{1})([\-\. ]?))((([0-9]{2})\3){3}([0-9]{2}))$/,guid:/^(\{?([0-9a-fA-F]){8}-(([0-9a-fA-F]){4}-){3}([0-9a-fA-F]){12}\}?)$/,time12:/^((0?\d)|(1[012])):[0-5]\d?\s?[aApP]\.?[mM]\.?$/,time24:/^(20|21|22|23|[01]\d|\d)(([:][0-5]\d){1,2})$/,nonHtml:/^[^<>]*$/};messages={required:"The field {field} is required.",grouprequired:"At least one field required.",integer:"The field {field} must be numeric.",number:"The field {field} must be numeric.",email:"Invalid email adress.",url:"Invalid URL.",phone:"Invalid phone number.",lowerthan:"{field1} must be lower than {field2}.",greaterthan:"{field1} must be greater than {field2}.",zip:"Invalid postcode."};e.fn.validateForm=function(i){i=e.extend({mode:"single",errorElementId:"errors",disableFieldStyle:false,stepByStep:false,scrollToFirstError:false},i);formElement=e(this);formHasError=false;activeErrorElements=new Array;formElement.find("input, select, textarea").each(function(){element=e(this);defaultValue=element.attr("title");errorElement=r(i.mode,element,i.errorElementId);value=element.val();for(var o in validationMethods){method=validationMethods[o];if(element.hasClass(method)){if(method=="required"){check=element.val()==""||element.val()==defaultValue||element.find("option:selected").text()==defaultValue}else if(method=="lowerthan"||method=="greaterthan"){relatedElement=e("#"+element.attr("data-error-"+method));relatedValue=parseInt(s(relatedElement.val()));value=parseInt(s(value));if(relatedElement&&relatedElement&&patterns["number"].test(relatedValue+value)){if(method=="lowerthan"){check=value>relatedValue&&value!=defaultValue}else{check=value<relatedValue&&value!=defaultValue}}}else if(method=="grouprequired"){elementsRequired=e('[data-error-grouprequired="'+element.attr("data-error-grouprequired")+'"]');check=true;elementsRequired.each(function(){if(!(e(this).val()==""||e(this).val()==e(this).attr("title")==true)){check=false;return}})}else{pattern=patterns[method];check=!pattern.test(value)&&value!=defaultValue}if(check){if(jQuery.inArray(errorElement,activeErrorElements)<=-1){t(i.mode,errorElement,element,method,i.disableFieldStyle);activeErrorElements.push(errorElement.attr("id"))}formHasError=true;if(i.stepByStep){return false}break}else{if(jQuery.inArray(errorElement.attr("id"),activeErrorElements)<=-1)n(i.mode,errorElement,element,i.disableFieldStyle)}}}});if(formHasError&&i.scrollToFirstError){e("html,body").animate({scrollTop:e(".error-wrapper:visible").first().parents().first().offset().top},"slow")}return!formHasError}})(jQuery)